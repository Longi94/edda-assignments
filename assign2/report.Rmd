---
title: "Assignment 2"
author: "Daniel Galea, Konrad Karas and Long Tran, group 6"
date: "28 February 2018"
output: pdf_document
fontsize: 11pt
highlight: tango
---

## Exercises

### Exercise 1
After conducting the bootstrap test and analyzing the P value we can conclude that the distribution does not stem from the exponential distribution.
Furthermore, the histogram has a bell-shaped curve rather than an exponential curve.

The bootstrap test was conducted in the following way:
```{r, echo=False, fig.height=6}
x=seq(0,max(data),length=1000)

t_stat = median(data)
B = 1000
tstar = numeric(B)
n = length(data)
for(i in 1:B){
 xstar = rexp(n,c(0.01,0.1))
 tstar[i] = median(xstar)
}

hist(tstar, prob=T)
pl = sum(tstar<t_stat)/B
pr=sum(tstar>t_stat)/B
p = 2*min(pl,pr)
p
```

\pagebreak

### Exercise 2

\pagebreak

### Exercise 3

*Point 1*

Null hypothesis: Median duration is smaller or equal to 31 days.

***Choosing appropriate test***

To choose appropriate test for this exercise, we have to analyse given data.
Data consist one numerical outcome for experimental unit - part delivery duration.
Histogram and Q-Q Plot were made to check distribution of data.

```{r, echo=FALSE, fig.height=6}
data = scan("klm.txt")
par(mfrow=c(1,2))
hist(data, prob=T)
qqnorm(data)
```

Analysis shows, that given data has distribution far away from normal.
In this case we cannot use t-test as it gives the best results for normal distribution.
For test purposes we will use sign test as it is recommended for random data distribution.

```{r}
# m0 = 31 - expected median duration
m0 = 31
ns = sum(data <= m0) #number of successes
nt = length(data) #number of trials
result = binom.test(ns,nt,p=0.5) # p=0.5 - we consider median duration (N/2)
result
p = result[[3]]
p
```

Power value is less than 0,05% so we have to reject our null hypothesis.

*Point 2*

Null hypothesis: At most 10% of the parts arrives after maximum period of 72 days.

As we are working with the same set of data, we will use sign test one more time.

```{r}
ns2 = sum(data > 72); # amount of deliveries that exceeded 72 days
result = binom.test(ns_2,nt,p=0.1) # p=0.1 - we consider that at most 10% of data is successfull
result
p = result[[3]]
p
```

Power value is less than 0,05% so we have to reject our null hypothesis.

\pagebreak

### Exercise 4

In this exercise we will test if seeding clouds has impact on rainfall.

```{r, echo=FALSE, fig.height=6}
clouds = read.table("clouds.txt",header=TRUE)
par(mfrow=c(1,2))
boxplot(clouds[,1],clouds[,2],names=c("seeded","unseeded"))
plot(clouds[,1],clouds[,2])
abline(0,1)

seeded = clouds[,1]
unseeded = clouds[,2]
```

Null hypothesis: Both populations (seeded and unseeded clouds) are the same

***Checking correlation***
Before performing tests, we will check correlation between both populations unisg Spearman method.

```{r}
cor.test(seeded,unseeded,method="spearman")
```

Calculated rho value (0.168) is low so there is no significant correlation between populations.

*Point 1*

Analyse of data:

```{r, echo=FALSE, fig.height=6}
par(mfrow=c(2,2))
hist(seeded)
qqnorm(seeded)
hist(unseeded)
qqnorm(unseeded)
```

Both populations do not follow normal distribution

***Two samples t-test***

```{r}
t.test(seeded,unseeded)
```

Power value is greather than 0.05, so we should not reject our null hypothesis.
However, two samples t-test should be based on normal data distribution so we cannot trust the results here.

***Mann-Whitney test***

Mann-Whitney test assumes that population follows random distribution so we expect reliable results.

```{r}
wilcox.test(seeded,unseeded)
```

Power value of Mann-Whitney test is less than 0.05. Null hypothesis is rejected.

***Kolmogorov-Smirnov test***

Kolmogorov-Smirnov test is based on the differences in the histograms of the two samples.

```{r}
ks.test(seeded,unseeded)
```

Power value of Kolmogorov-Smirnov test is less than 0.05. Null hypothesis is rejected.

*Point 2*

Whole procedure will be repeated on square root of the values in given data.

```{r, echo=FALSE, fig.height=6}
sqrt_seeded = sqrt(seeded)
sqrt_unseeded = sqrt(unseeded)

par(mfrow=c(2,2))
hist(sqrt_seeded)
qqnorm(sqrt_seeded)
hist(sqrt_unseeded)
qqnorm(sqrt_unseeded)
```

We can see that data distribution can still be considered as random but Q-Q Plots show that now we are slightly closer to normal distribution than in Point 1.

***Two samples t-test***

```{r}
t.test(sqrt_seeded,sqrt_unseeded)
```

Power value is less than 0.05. Null hypothesis is rejected.
Because we use data that distribution is closer to normal, it affected on t-test results.

***Mann-Whitney test***

```{r}
wilcox.test(sqrt_seeded,sqrt_unseeded)
```

Power value of Mann-Whitney test is less than 0.05. Null hypothesis is rejected.
The change of data didn't affect on test result.

***Kolmogorov-Smirnov test***

```{r}
ks.test(sqrt_seeded,sqrt_unseeded)
```

Power value of Kolmogorov-Smirnov test is less than 0.05. Null hypothesis is rejected.
The change of data didn't affect on test result.

*Point 3*

Whole procedure will be repeated on the square root of the square root of the values in given data.

```{r, echo=FALSE, fig.height=6}
sqrt2_seeded = sqrt(sqrt(seeded))
sqrt2_unseeded = sqrt(sqrt(unseeded))

par(mfrow=c(2,2))
hist(sqrt2_seeded)
qqnorm(sqrt2_seeded)
hist(sqrt2_unseeded)
qqnorm(sqrt2_unseeded)
```

Distribution of the square root of the square root of the values in given data habe normal distribution.

***Two samples t-test***

```{r}
t.test(sqrt2_seeded,sqrt2_unseeded)
```

Power value is less than 0.05. Null hypothesis is rejected.
Because now data has normal distribution, we can consider this test as reliable.

***Mann-Whitney test***

```{r}
wilcox.test(sqrt2_seeded,sqrt2_unseeded)
```

Power value of Mann-Whitney test is less than 0.05. Null hypothesis is rejected.
The change of data again didn't affect on test result.

***Kolmogorov-Smirnov test***

```{r}
ks.test(sqrt2_seeded,sqrt2_unseeded)
```

Power value of Kolmogorov-Smirnov test is less than 0.05. Null hypothesis is rejected.
The change of data again didn't affect on test result.

**Conclusion**
We can consider null hypothesis as rejected. Seeding clouds have affect on rainfall.
Manipulation in data (calculating square and square of square values of data) affected only on two samples t-test as it is based on normal distribution.
Because Mann-Whitney test is based ranks and Kolmogorov-Smirnov test is based on the differences in the histograms of the two samples, manipulation of data didn't affect on results of these tests.

\pagebreak

### Exercise 5

\pagebreak

### Exercise 6
```{r, echo=FALSE}
data = read.table("run.txt", header=TRUE)
before = data[,1]
after = data[,2]
soft_d_before = before[1:12]
soft_d_after = after[1:12]
energy_d_before = before[13:24]
energy_d_after = after[13:24]
```
**point 1**
**point 2**
After conducting the appropriate t-tests, we can conclude that there is no difference in speed after drinking both the soft drinks and energy drinks

```{r}
#Q2
#test difference in speed before and after soft drink
t.test(soft_d_before, soft_d_after, paired=TRUE)

#test difference in speed before and after energy drink
t.test(energy_d_before, energy_d_after, paired=TRUE)
```

**point 3**
A permutation test was performed, and the p value was analyzed. The p value was very high, greater than 0.9. Therefore we can reject the null hypothesis, meaning that the type differences are not affected by the type of drinks.

The test was conducted in the following way:
```{r}
tstat = function(x,y){mean(x-y)}
B = 1000
tstar = numeric(B)
for(i in 1:B){
  tempstar = t(apply(cbind(before,after), 1, sample))
  tstar[i] = tstat(tempstar[,1], tempstar[,2])
}

 myt= tstat(before, after)
 hist(tstar)
 pl=sum(tstar<myt)/B
 pr=sum(tstar>myt)/B
 p=2*min(pl,pr)
 p 
```

**point 4**
There would be no need for the softdrinks, which would give us a bigger sample size for energy drinks.

**point 5**
Yes the objection is similar as the participants should not have been split, but rather all of them should have drank the energy drink and then drank the soft drink and ran, so that you can compare time differences for the same person since different people might simply have different running speed.
Furthermore, maybe the initial run (without drinking energy drinks or softdrinks) could have been removed since this would mean that the participants might be too tired for the 3rd run.
\pagebreak

### Exercise 7

\pagebreak
