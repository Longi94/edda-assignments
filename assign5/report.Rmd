---
title: "Final Assignment"
author: "Daniel Galea, Konrad Karas and Long Tran, group 6"
date: "21 March 2018"
output: pdf_document
fontsize: 11pt
highlight: tango
---

### Exercise Galapagos

```{r}
galapagos = read.table("gala.txt", header = TRUE)
attach(galapagos)
```

**Point 1**

```{r}
summary(lm(Species ~ Area + Elevation + Nearest + Scruz + Adjacent, data = galapagos))
```


```{r}
summary(lm(Species ~ Area + Elevation + Scruz + Adjacent, data = galapagos))
```

```{r}
summary(lm(Species ~ Elevation + Scruz + Adjacent, data = galapagos))
```

```{r}
summary(lm(Species ~ Elevation + Adjacent, data = galapagos))
```


Using the step-down approach, we look at the highest p-value (which must also be greater than 0.05) and remove it, and run the model again. This is done until the remaining variables are significant. In this case we first removed the variable $nearest$ followed by $area$ and finally $scruz$.


**Point 2**


```{r}
summary(lm(sqrt(Species) ~ Area + Elevation + Nearest + Scruz + Adjacent, data = galapagos))
```

```{r}
summary(lm(sqrt(Species) ~ Area + Elevation + Scruz + Adjacent, data = galapagos))
```

```{r}
summary(lm(sqrt(Species) ~ Area + Elevation + Adjacent, data = galapagos))
```

```{r}
summary(lm(sqrt(Species) ~ Elevation + Adjacent, data = galapagos))


```

Using the step-down approach we first removed $nearest$ followed by $scruz$ and finally $area$.



**Point 3**

```{r}
model1 = lm(Species ~ Elevation + Adjacent, data = galapagos)
model2 = lm(sqrt(Species) ~ Elevation + Adjacent, data = galapagos)

par(mfrow = c(1, 2))
qqnorm(residuals(model1))
qqline(residuals(model1))
plot(fitted(model1), residuals(model1))

par(mfrow = c(1, 2))
qqnorm(residuals(model2))
qqline(residuals(model2))
plot(fitted(model2), residuals(model2))
```

Looking at the above plots we can conclude that the linear model with the response $sqrt(Species)$ is the better model as its residuals are more normal and the fitted plot is equally spread out.



**Point 4**

```{r}
round(cooks.distance(model2), 2)
plot(1:30, cooks.distance(model2))
```

```{r}
model3 = lm(sqrt(Species) ~ Elevation + Adjacent, data = galapagos[-16, ])
summary(model3)
```


**Point 5**

```{r}
par(mfrow=c(2,3))
for (i in 1:6) hist(galapagos[,i],main=colnames(galapagos)[i],xlab="",ylab="")
pairs(galapagos, panel=panel.smooth)
for (i in 1:6) hist(log(galapagos[,i]),main=colnames(galapagos)[i],xlab="",ylab="")
pairs(log(galapagos), panel=panel.smooth)
```


**Point 6**

**Point 7**

**Point 8**

**Point 9**

**Point 10**

